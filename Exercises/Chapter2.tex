\documentclass[12pt, a4paper]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{titlesec}
\usepackage{tcolorbox}
\usepackage{enumitem}
\usepackage[bottom=3cm]{geometry}
\usepackage[hidelinks]{hyperref}
\tcbuselibrary{breakable}
\tcbuselibrary{skins}

\newtcolorbox{prob}[1]{colback=gray!5!white, colframe=gray!75!black, 
title=\textbf{Exercise #1}}

\newtcolorbox{sol}{
    breakable,
    colback=white,      % Background matches page
    colframe=white,     % Frame matches page (invisible)
    frame hidden,       % Hides the border line
    left=3mm, right=3mm,% MATCHES the Question box padding
    boxrule=0mm,        % No border width
    top=0mm, bottom=0mm,% Tight vertical spacing
    parbox=false,       % Allows paragraphs to break normally
    before upper={\textbf{Solution:}\par\medskip} % Automatically adds "Solution:" title
}

\begin{document}
\begin{prob}{2.2}
Are the random variables X and Y in the joint ensemble
of figure 2.2 independent?
\end{prob}
\begin{sol}
No, $P(x, y) \neq P(x)P(y)$ since each row or column are not proportional to each other.
\end{sol}
\bigskip

\begin{prob}{2.4}
An urn contains $K$ balls, of which $B$ are black and $W = K - B$ are white. Fred draws a ball at random from the urn and replaces
it, N times.
\begin{enumerate}
    \item[(a)] What is the probability distribution of the number of times a black
ball is drawn, $n_B$?
    \item[(b)] What is the expectation of $n_B$? What is the variance of $n_B$? What
is the standard deviation of $n_B$? Give numerical answers for the
cases $N = 5$ and $N = 400$, when $B = 2$ and $K = 10$.
\end{enumerate}
\end{prob}
\begin{sol}
\begin{enumerate}
\item[(a)] $P(n_B) = \binom{N}{n_B} (\frac{B}{K})^{n_B} (\frac{K - B}{K})^{N - n_B}$
\item[(b)] $\frac{B}{K} = \frac{1}{5}$, $\frac{K-B}{K} = \frac{4}{5}$ so the distribution is B($n$, $\frac{1}{5}$). \\[2ex]
Hence, \, $\operatorname{E}[n_b] = \frac{1}{5}n$, $\operatorname{Var}[n_B] = \frac{1}{5}n(1-\frac{1}{5})$, $\operatorname{Std}[n_B] = \sqrt{\operatorname{Var}[n_B]}$ \\[2ex]
For n = 5: \, $\operatorname{E}[n_b] = 1$, $\operatorname{Var}[n_B] = \frac{4}{5}$, $\operatorname{Std}[n_B] = \sqrt{\frac{4}{5}}$ \\[2ex]
For n = 400: \, $\operatorname{E}[n_b] = 80$, $\operatorname{Var}[n_B] = 64$, $\operatorname{Std}[n_B] = 8$ \\
\end{enumerate}
\end{sol}
\bigskip

\begin{prob}{2.5}
    An urn contains $K$ balls, of which $B$ are black and $W = K - B$ are white. We define the fraction $f_B \equiv \frac{B}{K}$. Fred draws $N$
times from the urn, exactly as in exercise 2.4, obtaining $n_B$ blacks, and
computes the quantity
\begin{equation}
z = \frac{(n_B - f_BN)^2}{Nf_B(1 - f_B)}. \tag{2.19}
\end{equation}
What is the expectation of $z$? In the case $N = 5$ and $f_B = \frac{1}{5}$, what
is the probability distribution of $z$? What is the probability that $z < 1$?
[Hint: compare $z$ with the quantities computed in the previous exercise.]
\end{prob}
\begin{sol}
\begin{align*}
    \operatorname{E}[z] &= \frac{1}{Nf_b(1-f_B)}(\operatorname{E}[n_B^2] - 2\operatorname{E}[f_B n_B N] + \operatorname{E}[f_B^2 N^2])
    &= \frac{1}{Nf(1-f)}(Nf(1-f) + N^2f^2 - 2N^2 f^2 + N^2f^2)
    &= 1
\end{align*}
With $N = 5$ and $f_B = \frac{1}{5}$,
\begin{align*}
    z &= \frac{(n_B - 1)^2}{\frac{4}{5}}
\end{align*}
so
\begin{center}
\begin{tabular}{|c|cccccc|}
    \hline
    $n_B$ & 0 & 1 & 2 & 3 & 4 & 5 \\
    \hline
    $z$ &\rule[-12pt]{0pt}{30pt} $\frac{5}{4}$ & 0 & $\frac{5}{4}$ & $5$ & $\frac{45}{4}$ & 20 \\
    \hline
\end{tabular}
\end{center}

Hence, 
$$P(z < 1) = P(n_B = 1) = \binom{5}{1} \cdot \left(\frac{1}{5}\right) \left(\frac{4}{5}\right)^4 = \frac{256}{625} = 0.4096$$
\end{sol}
\bigskip

\begin{prob}{2.8}
Assuming a uniform prior on $f_H$, $P(f_H) = 1$, solve the problem
posed in example 2.7 (p.30). Sketch the posterior distribution of $f_H$ and
compute the probability that the $N + 1$th outcome will be a head, for
\begin{enumerate}
\item[(a)] $N = 3$ and $n_H = 0$;
\item[(b)] $N = 3$ and $n_H = 2$;
\item[(c)] $N = 10$ and $n_H = 3$;
\item[(d)] $N = 300$ and $n_H = 29$.
\end{enumerate}

\end{prob}
\begin{sol}
\begin{align*}
    P(f_H | n_H, N) &= \frac{P(n_H | f_H, N) P(f_H)}{P(n_H | N)}
    &= \frac{P(n_H | f_H, N)}{P(n_H | N)} = \frac{\binom{N}{n_H} f_H^{n_H} (1-f_H)^{N-n_H}}{P(n_H | N)}
\end{align*}
Now,
\begin{align*}
    & \int P(f_H | n_H, N) df_H = 1 \\
    \iff & \frac{\binom{N}{n_H}}{P(n_H | N)} \int_{1}^{0} f_H^{n_H} (1-f_H)^{N-n_H} df_H = 1 \\
    \iff & P(n_H | N) = \binom{N}{n_H} \frac{\Gamma(n_H + 1) \Gamma(N-n_H+1)}{\Gamma(N+2)}\\
    & = \binom{N}{n_H} \frac{n_H! (N-n_H)!}{(N+1)!}\\
    & = \frac{n_H!(N-n_H)!}{(N+1)n_H!(N-n_H)!} = \frac{1}{N+1}
\end{align*}
so
$$P(f_H | n_H, N) = \frac{(N+1)!}{n_H!(N-n_H)!} f_H^{n_H} (1-f_H)^{N-n_H}$$

\vspace{1em}
The graph looks like this: \href{https://www.desmos.com/calculator/bjjlgnqg87}{www.desmos.com/calculator/bjjlgnqg87}

Now,
\begin{align*}
    \operatorname{E}[f_H] &= \int_{0}^{1} f_H P(f_H | n_H, N) df_H \\
    &= \frac{(N+1)!}{n_H!(N-n_H)!} \int_{0}^{1} f_H^{n_H+1}(1-f)^{N-n_H} df_H \\
    &= \frac{(N+1)!}{n_H!(N-n_H)!} \frac{(n_H+1)!(N-n_H)!}{(N+2)!} \\
    &= \frac{n_H+1}{N+2}
\end{align*}
Thus,
\begin{enumerate}
    \item[(a)] $\frac{1}{5}$
    \item[(b)] $\frac{3}{5}$
    \item[(c)] $\frac{4}{12} = \frac{1}{3}$
    \item[(d)] $\frac{30}{302} = \frac{15}{151}$
\end{enumerate}
\end{sol}
\bigskip

\begin{prob}{2.14}
    Prove Jensenâ€™s inequality.
\end{prob}
\begin{sol}
    We want to prove 
    $$
    \sum_{i=1}^{I} p_i f(x_i) \geq f(\sum_{i=1}^{I} p_i x_i) \quad \text{for} \, \sum p_i = 1 \quad \text{and $f$ convex.}
    $$
    Now,
    \begin{align*}
        f(\sum_{i=1}^{I} p_i x_i) &= f(p_1 x_1 + \sum_{i=1}^{I} p_i x_i) \\
        &\leq p_1 f(x_1) + [\sum_{i=2}^{I} p_i] [f(\frac{\sum_{i=2}^{I} p_i x_i}{\sum_{i=2}^{I} p_i})] \quad (\because \text{Definition of convex function}) \\
        &\leq p_1 f(x_1) + [\sum_{i=2}^{I} p_i] [\frac{p_2}{\sum_{i=2}^{I} p_i} f(x_2) + \frac{\sum_{i=3}^{I} p_i}{\sum_{i=2}^{I} p_i} f(\frac{\sum_{i=3}^{I} p_i x_i}{\sum_{i=3}^{I} p_i})] \\
        &= p_1 f(x_1) + p_2 f(x_2) + \frac{\sum_{i=3}^{I} p_i}{\sum_{i=2}^{I} p_i} f(\frac{\sum_{i=3}^{I} p_i x_i}{\sum_{i=3}^{I} p_i}) \\
        &= \dots \\
        &\leq p_1 f(x_1) + p_2 f(x_2) + p_3 f(x_3) + p_4 f(x_4) + \dots \\
        &= \sum_{i=1}^{I} p_i f(x_i) \quad \blacksquare
    \end{align*}
\end{sol}
\bigskip

\begin{prob}{2.16}
    \begin{enumerate}
        \item[(a)]Two ordinary dice with faces labelled 1,...,6 are
thrown. What is the probability distribution of the sum of the values? What is the probability distribution of the absolute difference
between the values?
\item[(b)] One hundred ordinary dice are thrown. What, roughly, is the probability distribution of the sum of the values? Sketch the probability
distribution and estimate its mean and standard deviation.
\item[(c)] How can two cubical dice be labelled using the numbers
${0, 1, 2, 3, 4, 5, 6}$ so that when the two dice are thrown the sum
has a uniform probability distribution over the integers $1 - 12$?
\item[(d)] Is there any way that one hundred dice could be labelled with integers such that the probability distribution of the sum is uniform?
    \end{enumerate}
\end{prob}
\begin{sol}
\begin{enumerate}
\item[(a)] let S = sum of values. \\[1em]
\begin{tabular}{|c|ccccccccccc|}
    \hline
    $s$ & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 \\
    \hline
    $P(S=s)$ & $\frac{1}{36}$ & $\frac{1}{18}$ & $\frac{1}{12}$ & $\frac{1}{9}$ & $\frac{5}{36}$ & $\frac{1}{6}$ & $\frac{5}{36}$ & $\frac{1}{9}$ & $\frac{1}{12}$ & $\frac{1}{18}$ & $\frac{1}{36}$ \\
    \hline
\end{tabular} \\

Let D = difference of values \\[1em]
\begin{tabular}{|c|cccccc|}
    \hline
    $d$ & 0 & 1 & 2 & 3 & 4 & 5 \\
    \hline
    $P(D=d)$ & $\frac{1}{6}$ & $\frac{1}{3}$ & $\frac{2}{9}$ & $\frac{1}{6}$ & $\frac{1}{9}$ & $\frac{1}{18}$ \\
    \hline
\end{tabular}
\item[(b)] 
\begin{align*}
    \operatorname{E}[S_{100}] &= 100 \operatorname{E}[s] \\
    &= 350 \quad (\because \text{Independent})  \\
    \operatorname{Var}[S_{100}] &= 100\operatorname{Var}[s] \\
    &= 100 \left(\frac{91}{6} - \left(\frac{7}{2}\right)^2\right) = \frac{875}{3} \approx 292
\end{align*}
$P(S=s)$ vs $s$ Graph will be bell-curve-like between 100 and 600 with mean 350.
\item[(c)] Die 1 with \{1, 2, 3, 4, 5, 6\} and die 2 with \{0, 0, 0, 6, 6, 6\}.
\item[(d)] Make $r$th die to be $\{0, 1, 2, 3, 4, 5\} \times 6^r$ so each combination will sum to a unique number. \\
This does not violate the CLT as variables are not identical and the Lindeberg Condition (no single variance dominate) is not satisfied.
\end{enumerate}
\end{sol}
\bigskip

\begin{prob}{2.17}
    If $q = 1 - p$ and $a = \ln p/q$, show that
\begin{equation}
    p = \frac{1}{1 + \exp(-a)}. \tag{2.50}
\end{equation}
Sketch this function and find its relationship to the hyperbolic tangent function $\tanh(u) = \frac{e^u - e^{-u}}{e^u + e^{-u}}$.

\medskip

\noindent It will be useful to be fluent in base-2 logarithms also. If $b = \log_2 p/q$, what is $p$ as a function of $b$?
\end{prob}
\begin{sol}
    \begin{align*}
        \frac{1}{1+\exp(-a)} &= \frac{1}{1 + \exp(-\ln \frac{p}{q})} = \frac{1}{1 + (\frac{p}{q})^{-1}} \\
        &= \frac{1}{1 + \frac{q}{p}} = \frac{p}{p + q} = p 
    \end{align*}
    Now, with tanh, 
    \begin{align*}
        p &= \frac{1}{1 + e^{-u}} \\
        &= \frac{1}{2} \frac{2e^{\frac{u}{2}}}{e^{\frac{u}{2}} + e^{-\frac{u}{2}}} \\
        &= \frac{1}{2} \left( \frac{e^{\frac{u}{2}} - e^{-\frac{u}{2}}}{e^{\frac{u}{2}} + e^{-\frac{u}{2}}} + 1 \right) \\
        &= \frac{1}{2} \tanh \left(\frac{u}{2}\right) + \frac{1}{2}
    \end{align*}
    For base 2,
    \begin{align*}
          & b = \log_2 \frac{p}{q} \\
        \iff & 2^b = \frac{p}{1-p} \\
        \iff & 2^b = \frac{p}{q} \\
        \iff & (2^b + 1)p = 2^b \\
        \iff & p = \frac{2^b}{2^b + 1} = \frac{1}{1 + 2^{-b}}
    \end{align*}
\end{sol}
\bigskip

\begin{prob}{2.18}
Let $x$ and $y$ be dependent random variables with $x$ a binary variable taking values in $\mathcal{A}_X = \{0, 1\}$. Use Bayes' theorem to show that the log posterior probability ratio for $x$ given $y$ is
\begin{equation}
\log \frac{P(x=1 | y)}{P(x=0 | y)} = \log \frac{P(y | x=1)}{P(y | x=0)} + \log \frac{P(x=1)}{P(x=0)}. \tag{2.51}
\end{equation}
\end{prob}
\begin{sol}
\begin{align*}
    \log \frac{P(x=1 | y)}{P(x=0 | y)} &= \log \frac{P(y | x=1) \cdot P(x=1) \cdot P(y)}{P(y | x=0)\cdot P(x=0)\cdot P(y)} \\
    &= \log \frac{P(y | x=1)}{P(y | x=0)} + \log \frac{P(x=1)}{P(x=0)}
\end{align*}
\end{sol}
\bigskip

\begin{prob}{2.19}
    Let $x, d_1$ and $d_2$ be random variables such that $d_1$ and $d_2$ are conditionally independent given a binary variable $x$. Use Bayes' theorem to show that the posterior probability ratio for $x$ given $\{d_i\}$ is
\begin{equation}
\frac{P(x=1 | \{d_i\})}{P(x=0 | \{d_i\})} = \frac{P(d_1 | x=1)}{P(d_1 | x=0)} \frac{P(d_2 | x=1)}{P(d_2 | x=0)} \frac{P(x=1)}{P(x=0)}. \tag{2.52}
\end{equation}
\end{prob}
\begin{sol}
    \begin{align*}
        \frac{P(x=1 | \{d_i\})}{P(x=0 | \{d_i\})} &=\frac{P(d_1, d_2 | x=1) P(x=1)}{P(d_1, d_2)} \cdot \frac{P(d_1, d_2)}{P(d_1, d_2 | x=0) P(x=0)} \\
        &= \frac{P(d_1 | x=1)}{P(d_1 | x=0)} \frac{P(d_2 | x=1)}{P(d_2 | x=0)} \frac{P(x=1)}{P(x=0)} \quad (\because d_1, d_2 \text{ independent})
    \end{align*}
\end{sol}
\bigskip

\begin{prob}{2.20}
    Consider a sphere of radius $r$ in an $N$-dimensional real space. Show that the fraction of the volume of the sphere that is in the surface shell lying at values of the radius between $r - \epsilon$ and $r$, where $0 < \epsilon < r$, is:
\begin{equation}
f = 1 - \left( 1 - \frac{\epsilon}{r} \right)^N. \tag{2.53}
\end{equation}
Evaluate $f$ for the cases $N = 2$, $N = 10$ and $N = 1000$, with (a) $\epsilon/r = 0.01$; (b) $\epsilon/r = 0.5$.

\end{prob}
\begin{sol}
    $V_{\text{sphere}} \propto r^N$ so with $a$ constant,\\
\begin{equation*}
    f = \frac{ar^N - a(r-\epsilon)^N}{ar^N} = 1 - (1 - \frac{\epsilon}{r})^N
\end{equation*}
\begin{enumerate}
    \item[(a)] 
\begin{tabular}{c|ccc}
    N & 2 & 100 & 1000 \\
    \hline
    f ($\frac{\epsilon}{r} = 0.01$) & 0.0199 & 0.63397 & 0.99996 \\
\end{tabular}
    \item[(b)] 
\begin{tabular}{c|ccc}
    N & 2 & 100 & 1000 \\
    \hline
    f ($\frac{\epsilon}{r} = 0.5$) & 0.75 & 1.0 & 1.0 \\
\end{tabular}
\end{enumerate}
\end{sol}
\bigskip


\begin{prob}{}
\end{prob}
\begin{sol}
\end{sol}
\bigskip

% template
\begin{prob}{}
\end{prob}
\begin{sol}
\end{sol}
\bigskip

\end{document}

